<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Consuming and producing events using Apache Kafka in Quarkus :: SonataFlow Guides</title>
    <meta name="description" content="Consuming and producing events with Kafka">
    <meta name="keywords" content="kogito, workflow, serverless, events, kafka">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">

<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="stylesheet" href="../../../_/css/menu.css">
<link rel="stylesheet" href="../../../_/css/tabs.css">
<link rel="stylesheet" href="../../../_/css/navbar.css">
<link rel="stylesheet" href="../../../_/css/custom.css">
<link rel="stylesheet" href="../../../_/css/home.css"><script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <div class="navbar-item">
                <a href="../../..">
                    <img src="../../../_/img/kogitoLogo_default_64px.png" height="50px" alt="Kogito logo"/>
                </a>
                <a class="navbar-item" href="../../..">
                    SonataFlow Guides
                </a>
            </div>
                <div class="navbar-item search hide-for-print">
                    <div id="search-field" class="field">
                        <input id="search-input" type="text" placeholder="Search docs">
                    </div>
                </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a class="navbar-item small-item" href="https://github.com/apache"
                       target="_blank" title="Follow KIE on GitHub">
                        <div class="github-icon"></div>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="serverlessworkflow" data-version="1.44.0-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">SonataFlow Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release_notes.html">Release notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/create-your-first-workflow-service-with-kn-cli-and-vscode.html">Creating and running workflow projects using KN CLI and Visual Studio Code</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/create-your-first-workflow-service.html">Creating a Quarkus Workflow Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Core Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/cncf-serverless-workflow-specification-support.html">Serverless Workflow Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/handling-events-on-workflows.html">Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/working-with-callbacks.html">Callbacks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/understanding-jq-expressions.html">jq Expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/understanding-workflow-error-handling.html">Error handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/configuration-properties.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/defining-an-input-schema-for-workflows.html">Input Schema</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/custom-functions-support.html">Custom Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/timeouts-support.html">Timeouts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/working-with-parallelism.html">Parallelism</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tooling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-overview.html">Editor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-vscode-extension.html">VS Code extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-chrome-extension.html">Chrome extension for GitHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-overview.html">Serverless Logic Web Tools</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-github-integration.html">Integration with GitHub</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-openshift-integration.html">Integration with OpenShift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-redhat-application-services-integration.html">Integration with Service Registries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-deploy-projects.html">Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../service-orchestration/orchestration-of-openapi-based-services.html">OpenAPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../service-orchestration/configuring-openapi-services-endpoints.html">Advanced Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../service-orchestration/working-with-openapi-callbacks.html">Callbacks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../service-orchestration/orchestration-of-grpc-services.html">gRPC</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Event Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="orchestration-of-asyncapi-based-services.html">AsyncAPI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="event-correlation-with-workflows.html">Event Correlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Quarkus</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="consume-producing-events-with-kafka.html">Apache Kafka</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="consume-produce-events-with-knative-eventing.html">Knative Eventing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Client Authentication</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../security/authention-support-for-openapi-services.html">OpenAPI Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../security/orchestrating-third-party-services-with-oauth2.html">OpenAPI OAuth2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Executing, Testing and Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Executing and Testing Workflows</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-overview.html">Developer UI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-instances-page.html">Workflow Instances</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-definition-page.html">Workflow Definitions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-monitoring-page.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-custom-dashboard-page.html">Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/kn-plugin-workflow-overview.html">Command Line</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Quarkus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/mocking-http-cloudevents-with-wiremock.html">Mocking HTTP CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/mocking-openapi-services-with-wiremock.html">Mocking OpenAPI Services</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/basic-integration-tests-with-restassured.html">Testing with REST Assured</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Quarkus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence/persistence-with-postgresql.html">PostgreSQL Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence/postgresql-flyway-migration.html">PostgreSQL Database Migration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence/integration-tests-with-postgresql.html">Integration Tests with PostgreSQL</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cloud/index.html">Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operator</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/install-serverless-operator.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/developing-workflows.html">Development Mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/referencing-resource-files.html">Referencing Workflow Resources</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/configuring-workflows.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/build-and-deploy-workflows.html">Building and Deploying Workflow Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/workflow-status-conditions.html">Custom Resource Status</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/known-issues.html">Known Issues</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/migration-guide.html">Migration Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Quarkus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/quarkus/build-workflow-image-with-quarkus-cli.html">Building Workflow Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/quarkus/deploying-on-minikube.html">Deploying on Minikube</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/quarkus/deploying-on-kubernetes.html">Deploying on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/quarkus/deploying-on-openshift.html">Deploying on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/quarkus/kubernetes-service-discovery.html">Service Discovery</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/camel-routes-integration.html">Camel Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/custom-functions-knative.html">Knative Serving</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/expose-metrics-to-prometheus.html">Exposing Prometheus Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/serverless-dashboard-with-runtime-data.html">Displaying workflow Data in Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Job Service</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../job-services/core-concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../job-services/quarkus-extensions.html">Quarkus Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-index/data-index-core-concepts.html">Core concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-index/data-index-service.html">Standalone service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-index/data-index-quarkus-extension.html">Quarkus Extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Use Cases</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../use-cases/orchestration-based-saga-pattern.html">Saga Orchestration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../use-cases/timeout-showcase-example.html">Timeouts Showcase</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SonataFlow Guides</span>
    <span class="version">1.44-RC</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../latest/index.html">SonataFlow Guides</a>
      <ul class="versions">
        <li class="version">
          <a href="../../main/index.html">snapshot</a>
        </li>
        <li class="version">
          <a href="../../1.45.0-SNAPSHOT/index.html">1.45-RC</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">1.44-RC</a>
        </li>
        <li class="version is-latest">
          <a href="../../latest/index.html">1.43</a>
        </li>
        <li class="version">
          <a href="../../1.42.0.Final/index.html">1.42</a>
        </li>
        <li class="version">
          <a href="../../1.41.0.Final/index.html">1.41</a>
        </li>
        <li class="version">
          <a href="../../1.40.0.Final/index.html">1.40</a>
        </li>
        <li class="version">
          <a href="../../1.39.0.Final/index.html">1.39</a>
        </li>
        <li class="version">
          <a href="../../1.38.0.Final/index.html">1.38</a>
        </li>
        <li class="version">
          <a href="../../1.37.0.Final/index.html">1.37</a>
        </li>
        <li class="version">
          <a href="../../1.36.1.Final/index.html">1.36</a>
        </li>
        <li class="version">
          <a href="../../1.35.0.Final/index.html">1.35</a>
        </li>
        <li class="version">
          <a href="../../1.34.0.Final/index.html">1.34</a>
        </li>
        <li class="version">
          <a href="../../1.33.0.Final/index.html">1.33</a>
        </li>
        <li class="version">
          <a href="../../1.32.0.Final/index.html">1.32</a>
        </li>
        <li class="version">
          <a href="../../1.31.1.Final/index.html">1.31</a>
        </li>
        <li class="version">
          <a href="../../1.30.0.Final/index.html">1.30</a>
        </li>
        <li class="version">
          <a href="../../1.29.0.Final/index.html">1.29</a>
        </li>
        <li class="version">
          <a href="../../1.28.0.Final/index.html">1.28</a>
        </li>
        <li class="version">
          <a href="../../1.27.0.Final/index.html">1.27</a>
        </li>
        <li class="version">
          <a href="../../1.26.0.Final/index.html">1.26</a>
        </li>
        <li class="version">
          <a href="../../1.25.0.Final/index.html">1.25</a>
        </li>
        <li class="version">
          <a href="../../1.24.1.Final/index.html">1.24</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">SonataFlow Guides</a></li>
    <li>Event Orchestration</li>
    <li>Quarkus</li>
    <li><a href="consume-producing-events-with-kafka.html">Apache Kafka</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.44-RC</button>
  <div class="version-menu">
    <a class="version" href="../../main/eventing/consume-producing-events-with-kafka.html">snapshot</a>
    <a class="version" href="../../1.45.0-SNAPSHOT/eventing/consume-producing-events-with-kafka.html">1.45-RC</a>
    <a class="version is-current" href="consume-producing-events-with-kafka.html">1.44-RC</a>
    <a class="version" href="../../latest/eventing/consume-producing-events-with-kafka.html">1.43</a>
    <a class="version" href="../../1.42.0.Final/eventing/consume-producing-events-with-kafka.html">1.42</a>
    <a class="version" href="../../1.41.0.Final/eventing/consume-producing-events-with-kafka.html">1.41</a>
    <a class="version" href="../../1.40.0.Final/eventing/consume-producing-events-with-kafka.html">1.40</a>
    <a class="version" href="../../1.39.0.Final/eventing/consume-producing-events-with-kafka.html">1.39</a>
    <a class="version" href="../../1.38.0.Final/eventing/consume-producing-events-with-kafka.html">1.38</a>
    <a class="version" href="../../1.37.0.Final/eventing/consume-producing-events-with-kafka.html">1.37</a>
    <a class="version" href="../../1.36.1.Final/eventing/consume-producing-events-with-kafka.html">1.36</a>
    <a class="version" href="../../1.35.0.Final/eventing/consume-producing-events-with-kafka.html">1.35</a>
    <a class="version" href="../../1.34.0.Final/eventing/consume-producing-events-with-kafka.html">1.34</a>
    <a class="version" href="../../1.33.0.Final/eventing/consume-producing-events-with-kafka.html">1.33</a>
    <a class="version" href="../../1.32.0.Final/eventing/consume-producing-events-with-kafka.html">1.32</a>
    <a class="version" href="../../1.31.1.Final/eventing/consume-producing-events-with-kafka.html">1.31</a>
    <a class="version" href="../../1.30.0.Final/eventing/consume-producing-events-with-kafka.html">1.30</a>
    <a class="version" href="../../1.29.0.Final/eventing/consume-producing-events-with-kafka.html">1.29</a>
    <a class="version" href="../../1.28.0.Final/eventing/consume-producing-events-with-kafka.html">1.28</a>
    <a class="version" href="../../1.27.0.Final/eventing/consume-producing-events-with-kafka.html">1.27</a>
    <a class="version" href="../../1.26.0.Final/eventing/consume-producing-events-with-kafka.html">1.26</a>
    <a class="version" href="../../1.25.0.Final/eventing/consume-producing-events-with-kafka.html">1.25</a>
    <a class="version" href="../../1.24.1.Final/eventing/consume-producing-events-with-kafka.html">1.24</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/apache/incubator-kie-kogito-docs/edit/1.44.x/serverlessworkflow/modules/ROOT/pages/eventing/consume-producing-events-with-kafka.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Consuming and producing events using Apache Kafka in Quarkus</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document describes how you can configure a workflow to interact with <a href="https://kafka.apache.org/documentation/">Apache Kafka</a>. Apache Kafka uses an abstraction called topic to classify events. Events are published to a topic, and events are consumed from a topic.</p>
</div>
<div class="paragraph">
<p>SonataFlow uses <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/3.3/connectors/connectors.html">Smallrye connectors</a> to encapsulate access to several brokers, enabling SonataFlow to support different brokers by changing the configuration and classpath dependencies. However, Smallrye connectors also introduce an entity called channel. The Smallrye channels are unidirectional and need to be declared as input (<code>incoming</code>) or output (<code>outgoing</code>). When using Apache Kafka, the Smallrye channels must be mapped to Apache Kafka topics through configuration.</p>
</div>
<div class="paragraph">
<p>You need to add the Kafka Quarkus Smallrye connector dependency to indicate that you are using Apache Kafka. To enable a workflow to use Apache Kafka Smallrye connector, add the following dependency to the <code>pom.xml</code> file of your project if using Apache Maven:</p>
</div>
<div class="listingblock">
<div class="title">Add dependency for Apache Kafka Smallrye connector in <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The messaging capabilities are included in the Quarkus Serverless Workflow extension, even though the messaging capabilities are optional. This means you do not need to explicitly add the messaging add-on dependency when using SonataFlow.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-sw-smallrye-channel-configuration"><a class="anchor" href="#con-sw-smallrye-channel-configuration"></a>Smallrye channels configuration for a workflow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure Smallrye channels for a workflow using event definitions. The Smallrye channels are defined using <a href="https://quarkus.io/guides/config">Quarkus configuration</a>. The format for Smallrye channel properties is <code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.&lt;property_name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>SonataFlow allows the following channel mapping strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define one default incoming channel to receive all the incoming messages and one default outgoing channel to store all the published messages.</p>
</li>
<li>
<p>Define a channel for each <a href="https://cloudevents.io/">CloudEvent</a> type so that every message type has a dedicated channel.</p>
</li>
<li>
<p>Define a channel for certain CloudEvent types. The non-mapped CloudEvent types uses the default incoming or outgoing channel.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SonataFlow first searches for a channel name in the properties that is same as CloudEvent type. If the channel name is found, SonataFlow uses the channel for that CloudEvent type. However, if the channel name is not found, SonataFlow searches for the default channel definition. In case the default channel definition is not existing, then an error is reported.</p>
</div>
<div class="paragraph">
<p>The default incoming channel is <code>kogito_incoming_stream</code> and the default outgoing channel is <code>kogito_outgoing_stream</code>.</p>
</div>
<div class="paragraph">
<p>To change the default incoming and outgoing topic names, you can use the following properties:</p>
</div>
<div class="listingblock">
<div class="title">Properties to change default incoming and outgoing topic names</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">kogito.addon.messaging.incoming.defaultName=&lt;default channel name&gt;
kogito.addon.messaging.outgoing.defaultName=&lt;default channel name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following properties are mandatory for each channel:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>connector</code>: This property needs to be set to <code>smallrye-kafka</code>.</p>
</li>
<li>
<p>Depending on whether the channel is incoming or outgoing:</p>
<div class="ulist">
<ul>
<li>
<p><code>value.deserializer</code>: This property is used for incoming channels. Unless you have specific marshaling requirements, you must set this property to <code>org.apache.kafka.common.serialization.ByteArrayDeserializer</code> or <code>org.apache.kafka.common.serialization.StringDeserializer</code>.</p>
</li>
<li>
<p><code>value.serializer</code>: This property is used for outgoing channels. Unless you have specific marshaling requirements, you must set this property to <code>org.apache.kafka.common.serialization.ByteArraySerializer</code> or <code>org.apache.kafka.common.serialization.StringSerializer</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>topic</code> is another relevant but optional property that might be set for a channel. The <code>topic</code> property contains the Apache Kafka topic name to be used for a channel. If <code>topic</code> property is not set, then the channel name is used as topic name.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about the properties that you can use for a channel when using Apache Kafka connector, see the <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/3.3/kafka/kafka.html#_configuration_reference">properties</a> list.</p>
</div>
<div class="sect2">
<h3 id="ref-example-smallrye-channel-mapping"><a class="anchor" href="#ref-example-smallrye-channel-mapping"></a>Examples of Smallrye channel mapping</h3>
<div class="paragraph">
<p>This section describes examples of channel mapping, using the properties mentioned in the previous section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">One Smallrye channel per CloudEvent type</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="https://github.com/kiegroup/kogito-examples/tree/1.44.x/serverless-workflow-examples/serverless-workflow-callback-quarkus/src/main/resources/application.properties"><code>serverless-workflow-callback-quarkus</code></a> example application uses two CloudEvent types, including <code>wait</code> (incoming) and <code>resume</code> (outgoing).</p>
</div>
<div class="paragraph">
<p>Kafka topic names match the CloudEvent types. Therefore, it is suitable to select the mapping strategy of one channel per CloudEvent type. This suggests that two channels must be configured. Note that you do not need to set the optional <code>topic</code> property as the channel name matches the CloudEvent type.</p>
</div>
<div class="listingblock">
<div class="title">Example property configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.incoming.wait.connector=smallrye-kafka
mp.messaging.incoming.wait.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer

mp.messaging.outgoing.resume.connector=smallrye-kafka
mp.messaging.outgoing.resume.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Default channel mapping</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="https://github.com/kiegroup/kogito-examples/tree/1.44.x/serverless-workflow-examples/serverless-workflow-events-quarkus/src/main/resources/application.properties"><code>serverless-workflow-events-quarkus</code></a> example application uses two CloudEvent types, including <code>applicants</code> (incoming) and <code>decisions</code> (outgoing).</p>
</div>
<div class="paragraph">
<p>As mentioned before, Kafka topic names match the CloudEvent types. However, to use the default channel functionality, <code>kogito_incoming_stream</code> and <code>kogito_outgoing_stream</code> are used as channel names. As explained before, since there is no specific channel name for the CloudEvent type, then the default channels are used. Also, the default channels need to be mapped to the desired topic name using the <code>topic</code> property.</p>
</div>
<div class="listingblock">
<div class="title">Example property configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka
mp.messaging.incoming.kogito_incoming_stream.topic=applicants
mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer

mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka
mp.messaging.outgoing.kogito_outgoing_stream.topic=decisions
mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_onoverflow_handling"><a class="anchor" href="#_onoverflow_handling"></a>OnOverflow handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Smallrye provide means to <a href="https://quarkus.io/blog/reactive-messaging-emitter/#overflow-management">manage emitter overflow</a> through <a href="https://smallrye.io/smallrye-reactive-messaging/2.0.3/apidocs/io/smallrye/reactive/messaging/annotations/OnOverflow.html">OnOverflow</a> annotation</p>
</div>
<div class="paragraph">
<p>Kogito will annotate generated smallrye <code>emitters</code> for a particular channel using the information provided by a property of the form <code>kogito.addon.messaging.emitter.&lt;channel_name&gt;.overflow-strategy</code>. The possible values are <code>BUFFER</code>, <code>NONE</code>, <code>UNBOUNDED</code>, <code>FAIL</code>, and <code>DROP</code>. If the value of the strategy is <code>BUFFER</code>, then you must specify the buffer size by using the property of the form <code>kogito.addon.messaging.emitter.&lt;channel_name&gt;.buffer-size</code></p>
</div>
<div class="paragraph">
<p>Therefore, for the <code>wait</code> channel, in the previous example, if we want to buffer as many as 100 events we will add these two properties</p>
</div>
<div class="listingblock">
<div class="title">Example overflow configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">kogito.addon.messaging.emitter.wait.overflow-strategy=BUFFER
kogito.addon.messaging.emitter.wait.buffer-size=100</code></pre>
</div>
</div>
<div class="paragraph">
<p>If all your channels use the same strategy and this strategy differs from the <code>BUFFER</code> one (you can change buffer size globally by using the <code>mp.messaging.emitter.default-buffer-size</code> smallrye property). You can set it up by using <code>kogito.addon.messaging.emitter.overflow-strategy=NONE|UNBOUNDED|FAIL|DROP</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a>Additional resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="consume-produce-events-with-knative-eventing.html" class="xref page">Consuming and producing events on Knative Eventing</a></p>
</li>
<li>
<p><a href="event-correlation-with-workflows.html" class="xref page">Event correlation in SonataFlow</a></p>
</li>
<li>
<p><a href="../core/working-with-callbacks.html" class="xref page">Callback state in SonataFlow</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_found_an_issue"><a class="anchor" href="#_found_an_issue"></a><em><strong>Found an issue?</strong></em></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you find an issue or any misleading information, please feel free to report it <a href="https://github.com/kiegroup/kogito-docs/issues/new">here</a>.
We really appreciate it!</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/tabsBehavior.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
